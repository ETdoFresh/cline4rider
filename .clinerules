<custom_rules>
    <background>
        <information>We are porting a vscode extension call Cline to Rider</information>
        <information>The existing vscode extension is found in ./cline</information>
        <information>The entry point to the extension is found in ./cline/src/extension.ts, please read before continuing</information>
        <information>A Port to Rider Specification document exists in ./PortSpecification.md, please read before continuing</information>
    </background>
    
    <build_requirements>
        <requirement>JDK 17 (JetBrains Runtime recommended)</requirement>
        <requirement>Gradle 8.6 or later</requirement>
        <requirement>IntelliJ Platform SDK</requirement>
    </build_requirements>

    <build_instructions>
        <step>To build the plugin: ./gradlew buildPlugin</step>
        <step>To run in development: ./gradlew runIde -q</step>
        <step>Plugin output will be in: build/distributions/cline4rider-[version].zip</step>
    </build_instructions>

    <development_notes>
        <note>Kotlin API version is set to 1.8 to match Rider 2024.1 requirements</note>
        <note>Code instrumentation is disabled to avoid JDK path issues</note>
        <note>Uses Rider 2024.1.1 SDK (RD-241.14494.326)</note>
    </development_notes>

    <gradle_rules>
        <rule>Do not use --info flag unless specifically requested by user</rule>
        <rule>After each task completion, run 'clean buildPlugin' to verify compilation</rule>
    </gradle_rules>

    <shell_handling>
        <powershell>
            <command_separator>;</command_separator>
            <command_variants>
                <variant>
                    <standard>rm -rf</standard>
                    <powershell>Remove-Item -Recurse -Force</powershell>
                </variant>
                <variant>
                    <standard>cat</standard>
                    <powershell>Get-Content</powershell>
                </variant>
                <variant>
                    <standard>ls</standard>
                    <powershell>Get-ChildItem</powershell>
                </variant>
                <variant>
                    <standard>mkdir</standard>
                    <powershell>New-Item -ItemType Directory</powershell>
                </variant>
                <variant>
                    <standard>cp</standard>
                    <powershell>Copy-Item</powershell>
                </variant>
                <variant>
                    <standard>mv</standard>
                    <powershell>Move-Item</powershell>
                </variant>
            </command_variants>
        </powershell>
    </shell_handling>

    <powershell_commands>
        <command>
            <name>Clean Gradle Cache and Rebuild</name>
            <script>Remove-Item -Path "$env:USERPROFILE\.gradle\caches" -Recurse -Force; ./gradlew clean --refresh-dependencies</script>
        </command>
        <command>
            <name>Stop Gradle Daemons</name>
            <script>./gradlew --stop</script>
        </command>
        <command>
            <name>Build with Debug</name>
            <script>./gradlew buildPlugin --debug</script>
        </command>
        <command>
            <name>Git Add and Commit</name>
            <script>git add . ; git commit -m "$args[0]"</script>
        </command>
        <command>
            <name>Git Add Commit Push</name>
            <script>git add . ; git commit -m "$args[0]" ; git push</script>
        </command>
    </powershell_commands>

    <task_completion_requirements>
        <requirement>Stop all Gradle daemons before building</requirement>
        <requirement>Clean and rebuild the project</requirement>
        <requirement>Run IDE for testing</requirement>
        <requirement>Verify compilation with clean buildPlugin</requirement>
        <command>./gradlew --stop ; ./gradlew clean buildPlugin ; ./gradlew runIde -q ; ./gradlew clean buildPlugin</command>
    </task_completion_requirements>
</custom_rules>
